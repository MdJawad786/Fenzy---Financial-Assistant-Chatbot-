<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fenzy - Personal Finance Assistant</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Tahoma, sans-serif; background: linear-gradient(135deg,#0f1419,#1a2332,#243447); color: white; height: 100vh; display: flex; justify-content: center; align-items: center; }
    .main-container { display: flex; width: 90%; max-width: 1200px; height: 90vh; background: rgba(255,255,255,0.05); backdrop-filter: blur(20px); border-radius: 25px; box-shadow: 0 25px 50px rgba(0,0,0,0.3); overflow: hidden; border: 1px solid rgba(255,255,255,0.1); }
    .sidebar { width: 300px; background: rgba(0,0,0,0.3); padding: 20px; display: flex; flex-direction: column; gap: 15px; }
    .logo { text-align: center; padding: 20px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
    .logo h1 { font-size: 28px; background: linear-gradient(45deg,#4facfe,#00f2fe); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .feature-btn { padding: 15px; background: rgba(79,172,254,0.2); border: 1px solid rgba(79,172,254,0.3); border-radius: 15px; cursor: pointer; transition: all .3s; }
    .feature-btn:hover { background: rgba(79,172,254,0.4); transform: translateY(-2px); }
    .user-profile { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 15px; margin-top: auto; }
    .user-profile h3 button { margin-left: 6px; }
    .profile-edit { display: none; margin-top: 10px; }
    .profile-edit input, .profile-edit select { width: 100%; margin-bottom: 10px; padding: 6px 8px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.25); background: rgba(255,255,255,0.08); color: white; }
    .profile-edit button { padding: 8px 10px; border: none; border-radius: 8px; cursor: pointer; margin-right: 6px; }
    .save-btn { background: #4facfe; color: black; }
    .cancel-btn { background: rgba(255,255,255,0.2); color: white; }
    .chat-container { flex: 1; display: flex; flex-direction: column; position: relative; }
    .chat-header { padding: 20px; background: rgba(0,0,0,0.2); text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1); z-index: 2; }
    .chat-messages { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 14px; position: relative; z-index: 2; }
    .message { padding: 15px; border-radius: 15px; max-width: 80%; animation: fadeIn .2s ease; word-wrap: break-word; }
    .user-message { align-self: flex-end; background: linear-gradient(135deg,#4facfe,#00f2fe); color: black; font-weight: 500; }
    .bot-message { align-self: flex-start; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.12); }
    .chat-input-container { padding: 20px; border-top: 1px solid rgba(255,255,255,0.1); z-index: 2; }
    .chat-input { display: flex; background: rgba(255,255,255,0.1); border-radius: 25px; overflow: hidden; border: 1px solid rgba(255,255,255,0.2); }
    .chat-input input { flex: 1; padding: 15px; background: transparent; border: none; color: white; outline: none; }
    .chat-input button { padding: 15px 25px; background: linear-gradient(135deg,#4facfe,#00f2fe); color: black; border: none; cursor: pointer; font-weight: bold; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(4px);} to { opacity: 1; transform: translateY(0);} }

    /* ===== Watermark Styling ===== */
    .watermark {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      font-size: 240px;
      font-weight: bold;
      color: rgba(255, 215, 0, 0.08); /* Golden color, very faint */
      display: flex;
      justify-content: center;
      align-items: center;
      pointer-events: none; /* so it doesn't block clicks */
      user-select: none;
      z-index: 1;
    }
  </style>
</head>
<body>
<div class="main-container">
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="logo"><h1>Fenzy</h1><p>Your Finance Assistant</p></div>
    <div class="feature-btn" onclick="sendQuickMessage('Show my budget analysis')">üí∞ Budget Analysis</div>
    <div class="feature-btn" onclick="sendQuickMessage('Analyze my spending')">üìä Spending Insights</div>
    <div class="feature-btn" onclick="sendQuickMessage('Investment options')">üìà Investment Advice</div>
    <div class="feature-btn" onclick="sendQuickMessage('Debt payoff strategy')">üí≥ Debt Strategy</div>

    <div class="user-profile">
      <h3>Your Profile <button onclick="toggleEdit()">‚úèÔ∏è</button></h3>
      <div id="profileView">
        <div><strong>Age:</strong> <span id="displayAge">28</span></div>
        <div><strong>Income:</strong> ‚Çπ<span id="displayIncome">5000</span></div>
        <div><strong>Expenses:</strong> ‚Çπ<span id="displayExpenses">3500</span></div>
        <div><strong>Savings:</strong> ‚Çπ<span id="displaySavings">15000</span></div>
        <div><strong>Debt:</strong> ‚Çπ<span id="displayDebt">8000</span></div>
        <div><strong>Risk:</strong> <span id="displayRisk">Moderate</span></div>
      </div>

      <div id="profileEdit" class="profile-edit">
        <input type="number" id="editAge" placeholder="Age">
        <input type="number" id="editIncome" placeholder="Income">
        <input type="number" id="editExpenses" placeholder="Expenses">
        <input type="number" id="editSavings" placeholder="Savings">
        <input type="number" id="editDebt" placeholder="Debt">
        <select id="editRisk">
          <option value="conservative">Conservative</option>
          <option value="moderate" selected>Moderate</option>
          <option value="aggressive">Aggressive</option>
        </select>
        <button class="save-btn" onclick="saveProfile()">Save</button>
        <button class="cancel-btn" onclick="toggleEdit()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Chat -->
  <div class="chat-container">
    <!-- Watermark Layer -->
    <div class="watermark">‚Çπ</div>

    <div class="chat-header">
      <h2>Personal Finance Assistant</h2>
      <p>Ask me about budgets, savings, investments, or debt payoff</p>
    </div>
    <div class="chat-messages" id="chatMessages"></div>
    <div class="chat-input-container">
      <div class="chat-input">
        <input type="text" id="userInput" placeholder="Type your question..." />
        <button id="sendBtn" onclick="sendMessage()">Send</button>
      </div>
    </div>
  </div>
</div>
<script>
  // ========== CONFIG ==========
  const OR_API_KEY = "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"; // replace with your OpenRouter key
  const OR_MODEL   = "qwen/qwen2.5-vl-72b-instruct:free";

  // ========== STATE ==========
  const messagesContainer = document.getElementById("chatMessages");
  const userInput         = document.getElementById("userInput");
  const sendBtn           = document.getElementById("sendBtn");

  // Conversation memory (system + user + assistant)
  let conversation = [
    { role: "system", content: "You are Fenzy, a professional yet friendly personal finance assistant. Always give clear, personalized, actionable advice based on the user's profile. All monetary amounts should be treated and discussed in Indian Rupees (‚Çπ). When providing financial advice, consider the Indian financial market, banking system, and investment options." }
  ];

  let userProfile = { age: 28, income: 5000, expenses: 3500, savings: 15000, debt: 8000, riskTolerance: "moderate" };

  // ========== UI HELPERS ==========
  function appendMessage(html, sender) {
    const msg = document.createElement("div");
    msg.classList.add("message", sender === "user" ? "user-message" : "bot-message");
    msg.innerHTML = html.replace(/\n/g, "<br>");
    messagesContainer.appendChild(msg);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
    return msg;
  }

  function showLoading() {
    const loader = document.createElement("div");
    loader.classList.add("message", "bot-message");
    loader.id = "loader";
    loader.innerHTML = "‚è≥ Thinking...";
    messagesContainer.appendChild(loader);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
  }

  function hideLoading() {
    const loader = document.getElementById("loader");
    if (loader) loader.remove();
  }

  // ========== PROFILE ==========
  function updateProfileDisplay() {
    document.getElementById("displayAge").textContent      = userProfile.age;
    document.getElementById("displayIncome").textContent   = userProfile.income;
    document.getElementById("displayExpenses").textContent = userProfile.expenses;
    document.getElementById("displaySavings").textContent  = userProfile.savings;
    document.getElementById("displayDebt").textContent     = userProfile.debt;
    document.getElementById("displayRisk").textContent     = userProfile.riskTolerance.charAt(0).toUpperCase() + userProfile.riskTolerance.slice(1);

    document.getElementById("editAge").value      = userProfile.age;
    document.getElementById("editIncome").value   = userProfile.income;
    document.getElementById("editExpenses").value = userProfile.expenses;
    document.getElementById("editSavings").value  = userProfile.savings;
    document.getElementById("editDebt").value     = userProfile.debt;
    document.getElementById("editRisk").value     = userProfile.riskTolerance;
  }

  function toggleEdit() {
    const view = document.getElementById("profileView");
    const edit = document.getElementById("profileEdit");
    const isEditing = edit.style.display === "block";
    view.style.display = isEditing ? "block" : "none";
    edit.style.display = isEditing ? "none"  : "block";
  }

  function saveProfile() {
    userProfile.age      = parseInt(document.getElementById("editAge").value);
    userProfile.income   = parseInt(document.getElementById("editIncome").value);
    userProfile.expenses = parseInt(document.getElementById("editExpenses").value);
    userProfile.savings  = parseInt(document.getElementById("editSavings").value);
    userProfile.debt     = parseInt(document.getElementById("editDebt").value);
    userProfile.riskTolerance = document.getElementById("editRisk").value;

    updateProfileDisplay();
    toggleEdit();
    appendMessage("‚úÖ Profile updated! I'll now personalize advice accordingly.", "bot");
  }

  // ========== PROMPT BUILDER ==========
  function buildUserMessage(userMessage) {
    const { age, income, expenses, savings, debt, riskTolerance } = userProfile;
    return `Profile (all amounts in Indian Rupees):
- Age: ${age}
- Income: ‚Çπ${income}
- Expenses: ‚Çπ${expenses}
- Savings: ‚Çπ${savings}
- Debt: ‚Çπ${debt}
- Risk tolerance: ${riskTolerance}

Question: ${userMessage}`;
  }

  // ========== OPENROUTER CALL ==========
  async function fetchAIResponse() {
    const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
      method: "POST",
      headers: {
        "Authorization": `Bearer ${OR_API_KEY}`,
        "HTTP-Referer": "YOUR_SITE_URL",
        "X-Title": "YOUR_SITE_NAME",
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        model: OR_MODEL,
        messages: conversation
      })
    });

    if (!response.ok) throw new Error("HTTP " + response.status);
    const data = await response.json();
    return data.choices?.[0]?.message?.content || "‚ö†Ô∏è No response.";
  }

  // ========== SEND ==========
  async function sendMessage() {
    const text = userInput.value.trim();
    if (!text) return;

    appendMessage(text, "user");
    userInput.value = "";

    // Add user input + profile to conversation
    conversation.push({ role: "user", content: buildUserMessage(text) });

    showLoading();

    try {
      const reply = await fetchAIResponse();
      hideLoading();
      appendMessage(reply, "bot");
      conversation.push({ role: "assistant", content: reply });
    } catch (err) {
      hideLoading();
      appendMessage("‚ö†Ô∏è Error: " + err.message, "bot");
    }
  }

  // ========== QUICK MESSAGE FUNCTION ==========
  function sendQuickMessage(message) {
    userInput.value = message;
    sendMessage();
  }

  // ========== EVENTS ==========
  userInput.addEventListener("keypress", e => { if (e.key === "Enter") sendMessage(); });

  // Init
  updateProfileDisplay();
  appendMessage("üëã Hi! I'm Fenzy. How can I help with your finances today?", "bot");
</script>
</body>
</html>